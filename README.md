# Выжимка по работе с Docker

Подноготная структуры Docker и подробно о всех основных функциях собрана в одном месте

## Оглавление
- [Выжимка по работе с Docker](#выжимка-по-работе-с-docker)
  - [Оглавление](#оглавление)
  - [Базовые понятия Docker](#базовые-понятия-docker)
  - [Управление контейнерами](#управление-контейнерами)
    - [Жизненный цикл контейнера](#жизненный-цикл-контейнера)
    - [Сигналы процессам](#сигналы-процессам)
    - [Основные команды Docker](#основные-команды-docker)
    - [Логи Docker](#логи-docker)
  - [Docker Image](#docker-image)
  - [Сети Docker](#сети-docker)
  - [Docker volumes](#docker-volumes)
  - [Docker-compose](#docker-compose)
  - [Docker registry](#docker-registry)

## Базовые понятия Docker

В Docker есть следующий типы объектов:
  - Builder
  - Config
  - Container
  - Context
  - Engine
  - Image
  - Network
  - Node
  - Plugin
  - Secret
  - Service
  - Stack
  - Swarm
  - System
  - Trust
  - Volume

## Управление контейнерами

`Docker container` - это сущность отвечающая за работу с контейнерами.  <br/>
Но название `container` можно опускать, поскольку в большинстве комманд он по умолчанию устроен под container, поскольку при работе с Docker очень приходится работать именно с container и поэтому команды работы с контейнерами вынесены на верхний уровень. Из-за этого следующие команды равны по своей сущности:  <br/>
`docker start` - `docker container start` <br/>
`docker stop` - `docker container stop`

### Жизненный цикл контейнера

Когда мы делаем `docker run` у нас скачивается `image`. Этот `Image` запускается и превращается в контейнер. После того как мы запустили контейнер у нас появляется жизненный цикл контейнера:

[![image.jpg](https://i.postimg.cc/vBhnvg6m/image.jpg)](https://postimg.cc/47Knf3PC)

Когда мы запустили контейнер, у него появляется жизненный этап `running`. Запускается наше приложение и контейнер работает.
Когда нужно остановить контейнер то необходимо использовать команду `docker stop`, которая приводит контейнер в состояние - `stopped`. 
Когда нужно контейнер уничтожить контейнер, то необходимо использовать команду `docker kill`. 
Когда нужно перезагрузить контейнер, то нужна команда `docker restart`. 
Когда нужно поставить контейнер на паузу, то нужна команда `docker pause`.
Если нужно удалить контейнер, то используется команда `docker rm` 
Если нужно удалить контейнер, даже если он запущен, тогда необходимо применить команду `docker rm -f`.

### Сигналы процессам

Каждая команда сопровождается сигналом, который позволяет нам завершить процесс:
| Комманда Docker | Сигнал | Пояснение |
| :-------------: | :----- | :-------- |
| docker stop | SIGTERM <br/> SIGKILL | При введении команды, Docker'у посылается команда SIGTERM, которая завершает процесс, но если в течении какого-то времени контейнер не останавливается, то через какое-то время Docker с помощью сигнала SIGNKILL убьёт этот контейнер. То есть даже если контейнер повис, Docker всё равно его убьёт |
| docker pause | SIGNSTOP | Ставит контейнер на паузу |
| docker kill | SIGNKILL | Убивает контейнер, даже если он повис |

### Основные команды Docker

| Комманда | Синтаксис | Пояснение |
| :------: | :-------- | :-------- |
| run --name | docker run --name <container_name> | Создание контейнера с указанным именем | 
| start | docker container start <container_name> | Запуск контейнера с указанным именем | 
| stop | docker container stop <container_name> | Остановка контейнера с указанным именем | 
| ps -a | docker ps -a | Вывести все (как запущенные так и остановленные) контейнеры | 
| ps  | docker ps | Вывести все запущенные контейнеры | 
| remove | docker container remove <container_name> | Удалить контейнера с указанным именем | 
| prune | docker container prune | Удалить все остановленные контейнеры | 
| rename | docker remae <old_container_name> <new_container_name> | Переименовать контейнер с указанным именем на новое имя |
| stats | docker stats | Выводит статистику по всем контейнерам в реальном времени таких параметров как: ЦПУ, использование памяти, выход и выход сети, ID процесса и т.д. |
| inspect | docker inspect <container_name> | Получить всю подробную информацию о контейнере в формате JSON, в том числе State, ID процесс или Image`и с которых был сделан контейнер |
| inspect -s | docker inspect -s <container_name> | Получить размер контейнера |
| inspect -f "{{.field}}" | docker inspect -f "{{.field.field}}" <container_name> | Получить детали конкретной строчки из JSON |

### Логи Docker

Контейнер на протяжении своего жизненного цикла создаёт логи. Чтобы получить все логи конкретного контейнера необходимо ввести комманду:
```
docker logs <container_name>
```

Поскольку лента логов достаточно длинная и поэтому слабо читабельная, то уже с помощью команд Linux есть возможность витянуть из логов что-то конкретное. 
Для этого необходимо использовать оператор пайпа ( | ), чтобы передать результаты предидущей команды в следующую команды, а также использовать функцию `grep`. Функция `grep` позволяет вытащить необходимый кусок текста описывая регулярные выражения в RegExp внутри запроса. 

| Комманда | Синтаксис | Пояснение |
| :------: | :-------- | :-------- |

## Docker Image

## Сети Docker

## Docker volumes

## Docker-compose

## Docker registry



